name: JavaApp Tomcat-jenkins-Docker-kubernates CI/CD

env:
  IMAGE: dockaleem/tomcat-app
  VERSION: "v1.0-${GITHUB_RUN_ID}"
  TOMCAT_HOME: /usr/local/tomcat

on:
  push:
    branches: [main]
  workflow_dispatch:

permissions:
  contents: write  # Correct indentation

jobs:

  checkout-code:
    runs-on: ubuntu-latest
    steps:
       - name: Checkout Code
         uses: actions/checkout@v4
         with:
           repository: ammukaleem/gitops-practice
           token: ${{ secrets.GITOPS_TOKEN }}
           path: gitops-practice
           ref: main
       - name: Debug Directory
         run: |
           pwd
           ls -l
         working-directory: gitops-practice 
       - name: Maven Test
         run: mvn clean package
         working-directory: gitops-practice
     #  - name: copy to target
     #    run: cp  /home/runner/work/gitops-practice/gitops-practice/gitops-practice/webapp/target/webapp-1.0-SNAPSHOT.war /gitops-practice/webapp/target/ 
  
 
          

